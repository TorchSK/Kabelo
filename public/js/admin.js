$(document).ready(function(){tinymce.init({selector:".richtext.editable",auto_focus:"mce_0",menubar:!1,plugins:["advlist autolink lists link image charmap print preview anchor textcolor","searchreplace visualblocks code fullscreen","insertdatetime media table contextmenu paste code help wordcount"],toolbar:"fontselect | code | insert | undo redo |  formatselect | bold italic backcolor  | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | removeformat | help",init_instance_callback:function(e){$(".text_files_list .item").click(function(){$path=$(this).data("content"),$extension=$path.split(".").pop(),$filename=$path.split("/").pop(),"jpg"==$extension?$content="<img src='/"+$path+"' width='100'>":$content="<a href='"+$path+"'>"+$filename+"</a>",e.insertContent($content)})}}),$(".admin_categories_list .accordion").nestedSortable({handle:".handle",items:".category",listType:"ul",disableParentChange:!1,stop:function(e,t){$data=[],$orders={},$parents={},$(".admin_categories_list .accordion .category").each(function(e,t){$orders[$(t).data("id")]=e,$parents[$(t).data("id")]=$(t).closest("li").parent().closest("li").data("id")}),$.ajax({method:"PUT",url:"/categories/setorder",data:{orders:$orders,parents:$parents}})}}),$(".pages_list").nestedSortable({handle:".handle",items:".item",listType:"ul",disableParentChange:!1,stop:function(e,t){$data=[],$orders={},$parents={},$(".pages_list .item").each(function(e,t){$orders[$(t).data("id")]=e,$parents[$(t).data("id")]=$(t).closest("li").parent().closest("li").data("id")}),$.ajax({method:"PUT",url:"/pages/setorder",data:{orders:$orders,parents:$parents}})}}),$(".change_cat_img_btn").click(function(){$("#category_image_dropzone").click()}),$("#xml_dropzone").dropzone({clickable:"#xml_upload_btn",success:function(e,t){$("#xml_url_input").val(t),$("#xml_url_input").data("external",0)}}),$("#catalogue_dropzone").dropzone({clickable:".catalogue_upload_btn",success:function(e,t){location.reload()}}),$("#sticker_dropzone").dropzone({clickable:".sticker_upload_btn",success:function(e,t){location.reload()}}),$("#catalogue_image_dropzone_1").dropzone({clickable:"#catalogue_image_btn_1",success:function(e,t){location.reload()}}),$("#catalogue_image_dropzone_2").dropzone({clickable:"#catalogue_image_btn_2",success:function(e,t){location.reload()}}),$("#catalogue_image_dropzone_3").dropzone({clickable:"#catalogue_image_btn_3",success:function(e,t){location.reload()}}),$("#product_detail_dropzone").dropzone({params:{_token:$('meta[name="csrf-token"]').attr("content")}}),$("#file_dropzone").dropzone({params:{_token:$('meta[name="csrf-token"]').attr("content")},success:function(e,t){location.reload()}}),$("#import_dropzone").dropzone({success:function(e,t){$table=$("#admin_import_results").find("table"),$row=$table.find("tbody tr"),$.each(t,function(e,t){$lastRow=$table.find("tbody tr:last-child"),$lastRow.find('td[col="name"]').html(t.name),$lastRow.find('td[col="code"]').html(t.code),$lastRow.find('td[col="maker"]').html(t.maker),console.log(t),$row.clone().appendTo($table)}),$table.find("tbody tr:last-child").remove()},params:{_token:$('meta[name="csrf-token"]').attr("content")}}),$("#category_image_dropzone").dropzone({success:function(e,t){this.removeAllFiles(!0),$categoryid=$("#category_image_div").data("categoryid"),$.ajax({method:"POST",url:"/category/"+$categoryid+"/image/confirmCrop",data:{filename:e.name},success:function(){location.reload()}})}}),$("#cover_dropzone").dropzone({clickable:["#admin_add_cover_change_image_btn","#cover_dropzone"],success:function(e,t){this.removeAllFiles(!0),$(".crop_preview").html("<img src=/"+t+" />").unbind("focus"),$(".admin_add_cover_under").css("display","flex"),$(".cover_image").show(),$("#cover_dropzone").hide(),$('#admin_add_cover_form input[name="filename"]').val(e.name),$("#admin_add_cover_change_image_btn").hide(),"cover"==$('input[name="type"]').val()?$aspect=$("#cover_ratio").text():$aspect=$("#banner_ratio").text(),$(".crop_preview img").cropper({guides:!1,viewMode:1,aspectRatio:$aspect,autoCropArea:1,crop:function(e){$('#admin_add_cover_form input[name="x"]').val(e.x),$('#admin_add_cover_form input[name="y"]').val(e.y),$('#admin_add_cover_form input[name="w"]').val(e.width),$('#admin_add_cover_form input[name="h"]').val(e.height)},preview:$(".cover_image .cover")}),$(".crop_ok").show().click(function(){$categoryid=$(this).data("categoryid"),$.ajax({method:"POST",url:"/category/"+$categoryid+"/image/confirmCrop",data:{filename:e.name,x:void 0,y:void 0,w:void 0,h:void 0},success:function(){location.reload()}})})}}),$(".ui.accordion").accordion({exclusive:!1}),$("#filterbar .ui.accordion").accordion({exclusive:!1,selector:{accordion:".accordion",title:".title",trigger:".title i",content:".content"}}),$(".admin_categories_list .ui.accordion").accordion({exclusive:!1,selector:{accordion:".accordion",title:".title",trigger:".name",content:".content"}}),$("#admin #grid .product.item").draggable({opacity:.6,helper:"clone"}),$(".categories .item").droppable({tolerance:"pointer",accept:".product",over:function(e,t){$(this).addClass("active")},out:function(e,t){$(this).removeClass("active")},deactivate:function(e,t){$(this).removeClass("active")},drop:function(e,t){$categoryId=$(this).data("categoryid"),$product=$(t.draggable),$.post("/product/"+$product.data("productid")+"/change/category/"+$categoryId,{},function(){$product.remove()}),$(this).removeClass("active")}}),$(".sticker_preview_div .sticker").draggable({containment:"parent",create:function(){stikcer_left=0,sticker_right=0},stop:function(){sticker_left=$(this).position().left,sticker_top=$(this).position().top}});var e=function(e,t){return t.children().each(function(){console.log(e),$(this).width($(this).width())}),t};$(".sticker_preview_div .sticker").resizable({containment:"parent",create:function(){sticker_width=$(this).width(),sticker_height=$(this).height()},stop:function(){sticker_width=$(this).width(),sticker_height=$(this).height()}}),$(".admin_cover_list").sortable({stop:function(){$data={},$(".admin_cover_list .banner").each(function(e,t){$data[$(t).data("id")]=e}),$.ajax({method:"PUT",url:"/admin/covers/setorder",data:$data})}}),$(".admin_banner_list").sortable({stop:function(){$data={},$(".admin_banner_list .banner").each(function(e,t){$data[$(t).data("id")]=e}),$.ajax({method:"PUT",url:"/admin/banners/setorder",data:$data})}}),$("#admin_new_wrapper table tbody").sortable({helper:e,stop:function(){$data={},$("#admin_new_wrapper table tbody tr").each(function(e,t){$data[$(t).data("id")]=e}),$.ajax({method:"PUT",url:"/products/new/setorder",data:$data})}}),$("#admin_sale_wrapper table tbody").sortable({helper:e,stop:function(){$data={},$("#admin_sale_wrapper table tbody tr").each(function(e,t){$data[$(t).data("id")]=e}),$.ajax({method:"PUT",url:"/products/sale/setorder",data:$data})}}),function(e,t,n,i){"use strict";t=void 0!==t&&t.Math==Math?t:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),e.fn.accordion=function(n){var i,o=e(this),a=(new Date).getTime(),c=[],r=arguments[0],s="string"==typeof r,l=[].slice.call(arguments,1);t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||t.msRequestAnimationFrame;return o.each(function(){var d,u,p=e.isPlainObject(n)?e.extend(!0,{},e.fn.accordion.settings,n):e.extend({},e.fn.accordion.settings),m=p.className,g=p.namespace,f=p.selector,h=p.error,v="."+g,$="module-"+g,b=o.selector||"",_=e(this),y=_.find(f.title),C=_.find(f.content),k=this,x=_.data($);u={initialize:function(){u.debug("Initializing",_),u.bind.events(),p.observeChanges&&u.observeChanges(),u.instantiate()},instantiate:function(){x=u,_.data($,u)},destroy:function(){u.debug("Destroying previous instance",_),_.off(v).removeData($)},refresh:function(){y=_.find(f.title),C=_.find(f.content)},observeChanges:function(){"MutationObserver"in t&&(d=new MutationObserver(function(e){u.debug("DOM tree modified, updating selector cache"),u.refresh()}),d.observe(k,{childList:!0,subtree:!0}),u.debug("Setting up mutation observer",d))},bind:{events:function(){u.debug("Binding delegated events"),_.on(p.on+v,f.trigger,u.event.click)}},event:{click:function(){u.toggle.call(this)}},toggle:function(t){var n=void 0!==t?"number"==typeof t?y.eq(t):e(t).closest(f.title):e(this).closest(f.title),i=n.next(C),o=i.hasClass(m.animating),a=i.hasClass(m.active),c=a&&!o,r=!a&&o;u.debug("Toggling visibility of content",n),c||r?p.collapsible?u.close.call(n):u.debug("Cannot close accordion content collapsing is disabled"):u.open.call(n)},open:function(t){var n=void 0!==t?"number"==typeof t?y.eq(t):e(t).closest(f.title):e(this).closest(f.title),i=n.next(C),o=i.hasClass(m.animating);if(i.hasClass(m.active)||o)return void u.debug("Accordion already open, skipping",i);u.debug("Opening accordion content",n),p.onOpening.call(i),p.onChanging.call(i),p.exclusive&&u.closeOthers.call(n),n.addClass(m.active),i.stop(!0,!0).addClass(m.animating),p.animateChildren&&(void 0!==e.fn.transition&&_.transition("is supported")?i.children().transition({animation:"fade in",queue:!1,useFailSafe:!0,debug:p.debug,verbose:p.verbose,duration:p.duration}):i.children().stop(!0,!0).animate({opacity:1},p.duration,u.resetOpacity)),i.slideDown(p.duration,p.easing,function(){i.removeClass(m.animating).addClass(m.active),u.reset.display.call(this),p.onOpen.call(this),p.onChange.call(this)})},close:function(t){var n=void 0!==t?"number"==typeof t?y.eq(t):e(t).closest(f.title):e(this).closest(f.title),i=n.next(C),o=i.hasClass(m.animating),a=i.hasClass(m.active),c=!a&&o,r=a&&o;!a&&!c||r||(u.debug("Closing accordion content",i),p.onClosing.call(i),p.onChanging.call(i),n.removeClass(m.active),i.stop(!0,!0).addClass(m.animating),p.animateChildren&&(void 0!==e.fn.transition&&_.transition("is supported")?i.children().transition({animation:"fade out",queue:!1,useFailSafe:!0,debug:p.debug,verbose:p.verbose,duration:p.duration}):i.children().stop(!0,!0).animate({opacity:0},p.duration,u.resetOpacity)),i.slideUp(p.duration,p.easing,function(){i.removeClass(m.animating).removeClass(m.active),u.reset.display.call(this),p.onClose.call(this),p.onChange.call(this)}))},closeOthers:function(t){var n,i,o,a=void 0!==t?y.eq(t):e(this).closest(f.title),c=a.parents(f.content).prev(f.title),r=a.closest(f.accordion),s=f.title+"."+m.active+":visible",l=f.content+"."+m.active+":visible";p.closeNested?(n=r.find(s).not(c),o=n.next(C)):(n=r.find(s).not(c),i=r.find(l).find(s).not(c),n=n.not(i),o=n.next(C)),n.length>0&&(u.debug("Exclusive enabled, closing other content",n),n.removeClass(m.active),o.removeClass(m.animating).stop(!0,!0),p.animateChildren&&(void 0!==e.fn.transition&&_.transition("is supported")?o.children().transition({animation:"fade out",useFailSafe:!0,debug:p.debug,verbose:p.verbose,duration:p.duration}):o.children().stop(!0,!0).animate({opacity:0},p.duration,u.resetOpacity)),o.slideUp(p.duration,p.easing,function(){e(this).removeClass(m.active),u.reset.display.call(this)}))},reset:{display:function(){u.verbose("Removing inline display from element",this),e(this).css("display",""),""===e(this).attr("style")&&e(this).attr("style","").removeAttr("style")},opacity:function(){u.verbose("Removing inline opacity from element",this),e(this).css("opacity",""),""===e(this).attr("style")&&e(this).attr("style","").removeAttr("style")}},setting:function(t,n){if(u.debug("Changing setting",t,n),e.isPlainObject(t))e.extend(!0,p,t);else{if(void 0===n)return p[t];e.isPlainObject(p[t])?e.extend(!0,p[t],n):p[t]=n}},internal:function(t,n){if(u.debug("Changing internal",t,n),void 0===n)return u[t];e.isPlainObject(t)?e.extend(!0,u,t):u[t]=n},debug:function(){!p.silent&&p.debug&&(p.performance?u.performance.log(arguments):(u.debug=Function.prototype.bind.call(console.info,console,p.name+":"),u.debug.apply(console,arguments)))},verbose:function(){!p.silent&&p.verbose&&p.debug&&(p.performance?u.performance.log(arguments):(u.verbose=Function.prototype.bind.call(console.info,console,p.name+":"),u.verbose.apply(console,arguments)))},error:function(){p.silent||(u.error=Function.prototype.bind.call(console.error,console,p.name+":"),u.error.apply(console,arguments))},performance:{log:function(e){var t,n,i;p.performance&&(t=(new Date).getTime(),i=a||t,n=t-i,a=t,c.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:k,"Execution Time":n})),clearTimeout(u.performance.timer),u.performance.timer=setTimeout(u.performance.display,500)},display:function(){var t=p.name+":",n=0;a=!1,clearTimeout(u.performance.timer),e.each(c,function(e,t){n+=t["Execution Time"]}),t+=" "+n+"ms",b&&(t+=" '"+b+"'"),(void 0!==console.group||void 0!==console.table)&&c.length>0&&(console.groupCollapsed(t),console.table?console.table(c):e.each(c,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),c=[]}},invoke:function(t,n,o){var a,c,r,s=x;return n=n||l,o=k||o,"string"==typeof t&&void 0!==s&&(t=t.split(/[\. ]/),a=t.length-1,e.each(t,function(n,i){var o=n!=a?i+t[n+1].charAt(0).toUpperCase()+t[n+1].slice(1):t;if(e.isPlainObject(s[o])&&n!=a)s=s[o];else{if(void 0!==s[o])return c=s[o],!1;if(!e.isPlainObject(s[i])||n==a)return void 0!==s[i]?(c=s[i],!1):(u.error(h.method,t),!1);s=s[i]}})),e.isFunction(c)?r=c.apply(o,n):void 0!==c&&(r=c),e.isArray(i)?i.push(r):void 0!==i?i=[i,r]:void 0!==r&&(i=r),c}},s?(void 0===x&&u.initialize(),u.invoke(r)):(void 0!==x&&x.invoke("destroy"),u.initialize())}),void 0!==i?i:this},e.fn.accordion.settings={name:"Accordion",namespace:"accordion",silent:!1,debug:!1,verbose:!1,performance:!0,on:"click",observeChanges:!0,exclusive:!0,collapsible:!0,closeNested:!1,animateChildren:!0,duration:350,easing:"easeOutQuad",onOpening:function(){},onClosing:function(){},onChanging:function(){},onOpen:function(){},onClose:function(){},onChange:function(){},error:{method:"The method you called is not defined"},className:{active:"active",animating:"animating"},selector:{accordion:".accordion",title:".title",trigger:".title",content:".content"}},e.extend(e.easing,{easeOutQuad:function(e,t,n,i,o){return-i*(t/=o)*(t-2)+n}})}(jQuery,window,document)});